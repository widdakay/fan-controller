[env:esp32-s3-devkitc-1]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino

monitor_speed = 115200
upload_speed = 115200

; upload_flags are for serial upload only, not OTA
; Commented out to allow OTA uploads
; upload_flags =
;     --before=default_reset
;     --after=hard_reset
;     --no-stub

build_unflags =
    -std=gnu++11

build_flags =
    -std=gnu++17
    -Iinclude
    -DCORE_DEBUG_LEVEL=3
    -DFIRMWARE_VERSION=\"1.0.0\"
    -DARDUINO_USB_CDC_ON_BOOT=1
    -Wall
    -Wextra
    -Wno-unused-parameter

lib_deps =
    adafruit/Adafruit ADS1X15@^2.5.0
    adafruit/Adafruit BME680 Library@^2.0.4
    adafruit/Adafruit Si7021 Library@^1.5.3
    wollewald/INA226_WE@^1.3.0
    knolleary/PubSubClient@^2.8.0
    paulstoffregen/OneWire@^2.3.7
    milesburton/DallasTemperature@^3.11.0
    bblanchon/ArduinoJson@^6.21.3

board_build.partitions = default.csv
board_build.usb_mode = cdc

; Test environment for unit tests
[env:test]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
test_framework = unity
test_build_src = no  ; Don't build main src/ files, only test files

monitor_speed = 115200
upload_speed = 115200
test_port = /dev/cu.usbmodem*
upload_port = /dev/cu.usbmodem*

build_unflags =
    -std=gnu++11

build_flags =
    -std=gnu++17
    -Iinclude
    -DCORE_DEBUG_LEVEL=3
    -DFIRMWARE_VERSION=\"1.0.0-test\"

lib_deps =
    ${env:esp32-s3-devkitc-1.lib_deps}
